<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <link rel="stylesheet" media="screen and (min-device-width: 1024px)" href="infocenter.css" type="text/css" />
    <link rel='stylesheet' media='screen and (max-device-width: 1023px)' href="infocenter-mobile.css" type="text/css" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kjetil's Information Center - Terminal Mode Commodore 64 Emulator</title>
  </head>
  <body>
    <div class="header">
      <img class="noborder" src="infocenter_header.png" alt="Kjetil's Information Center: A Blog About My Projects"/>
    </div>
    <div class="menu">
      <b>Index:</b>
      <p>
        <a href="index-topic.html">Index By Topic</a><br />
        <a href="index.html">Index By Date</a><br />
        <a href="rss.xml">RSS Feed</a><br />
      </p>
      <hr />
      <b>Contact:</b>
      <p>
        <a href="https://github.com/kobolt">https://github.com/kobolt</a><br />
        <a href="https://gitlab.com/users/kobolt/projects">https://gitlab.com/kobolt</a><br />
        kobolt.anarion (at) gmail.com<br />
      </p>
      <hr />
      <b>Quality assurance:</b>
      <p>
        <a href="http://validator.w3.org/check?uri=referer">
          <img class="noborder"
            src="valid-xhtml10.png"
            alt="Valid XHTML 1.0 Strict" />
        </a>
        <br />
        <a href="http://jigsaw.w3.org/css-validator/">
          <img class="noborder" 
            src="valid-css.gif"
            alt="Valid CSS" />
        </a>
        <br />
        <a href="https://validator.w3.org/feed/">
          <img class="noborder"
            src="valid-rss-rogers.png"
            alt="Valid RSS" />
        </a>
        <br />
      </p>
    </div>
    <div class="content">
      <h1>Terminal Mode Commodore 64 Emulator</h1>
      <p>
        Just for fun I have made a primitive Commodore 64 emulator, or more correctly mostly a 6502 CPU emulator that happens to run the Commodore 64 ROMs with just a few tweaks. It was mostly to learn about the <a href="https://en.wikipedia.org/wiki/MOS_Technology_6502">6502 CPU</a> itself, so if you actually need a proper emulator, then use <a href="https://vice-emu.sourceforge.io/">VICE</a> instead! The goal was to be able to load and run the Commodore BASIC ROM, which it does, in a Linux terminal.<br />
        <br />
        Anyway, I am releasing the source code under the MIT license and it can be downloaded <a href="supplies/tmce64-0.1.tar.gz">here</a>.<br />
        <br />
        The 6502 CPU is fully emulated and even supports decimal mode, although only with NMOS (not CMOS) compatibility, so the N, V and Z flags are not set correctly. Nevertheless it passes the excellent <a href="https://github.com/Klaus2m5/6502_65C02_functional_tests">test suite</a> made by Klaus Dormann, and even some of the <a href="http://www.softwolves.com/arkiv/cbm-hackers/7/7114.html">tests</a> made by Wolfgang Lorenz.<br />
        <br />
        To support the C64 architecture, some simple memory bank switching support has been implemented, and hooks are placed when reading and writing to certain memory locations to capture the user input and output. The emulator blocks on input when waiting for a keyboard press, which is hugely beneficial to CPU load. I thought about using <a href="https://en.wikipedia.org/wiki/Curses_(programming_library)">curses</a>, but this makes things more complicated so the emulator sets the terminal into canonical mode (with no echo) for the BASIC editor to work instead.<br />
        <br />
        To find the ROMs the emulator assumes that you have VICE installed from before, which puts these at &#34;/usr/lib64/vice/C64/&#34;. The location can be changed by editing a #define if they happen to be elsewhere.<br />
        <br />
        Here is what it looks like running in XTerm, and you can also see the CPU disassembly/trace and memory dump functionality embedded into the emulator:<br />
      </p>
      <img class="border" src="images/tmce64.png" alt="Terminal Mode Commodore 64 Emulator" />
      <p>
        <br />
      </p>
      <i>
        Topic:
        <a href="index-topic.html#open_source">Open Source</a>,
        by
        Kjetil
        @ 
        01/06-2021, 
        <a href="article-177.html">Article Link</a>
      </i>
      <br />
    </div>
  </body>
</html>
